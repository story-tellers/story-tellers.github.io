!function(){"use strict";var e,i;function n(){if(null==e){var i=function(){var e=window.location;"about:srcdoc"==e.href&&(e=window.parent.location);var i={};return function(e,n,t){for(;t=n.exec(e);)i[decodeURIComponent(t[1])]=decodeURIComponent(t[2])}(e.search.substring(1).replace(/\+/g,"%20"),/([^&=]+)=?([^&]*)/g),i}();e="referrer"in i?/^https:\/\/medium.com\//.test(i.referrer):!("auto"in i)}return e}function t(e){var i=e||window.innerWidth;return i>999?650:i>599?575:400}function o(e,n){if(window.top!==window.self){var t=window;if("srcdoc"==t.location.pathname&&(t=t.parent),i)return e=parseInt(e,10),console.log("sending AMP message",e),void t.parent.postMessage({sentinel:"amp",type:"embed-size",height:e},"*");var o={sender:"Flourish",context:"iframe.resize",method:"resize",height:e,src:t.location.toString()};if(n)for(var r in n)o[r]=n[r];t.parent.postMessage(JSON.stringify(o),"*")}}function r(){return-1!==navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")}function a(e){window.addEventListener("message",function(i){if(null!=i.source&&(i.origin===document.location.origin||i.origin.match(/\/\/localhost:\d+$|\.flourish\.(?:local(:\d+)?|rocks|studio)$/))){var n;try{n=JSON.parse(i.data)}catch(e){return void console.warn("Unexpected non-JSON message: "+JSON.stringify(i.data))}if("Flourish"===n.sender){for(var t=document.querySelectorAll("iframe"),o=0;o<t.length;o++)if(t[o].contentWindow==i.source||t[o].contentWindow==i.source.parent)return void e(n,t[o]);console.warn("could not find frame",n)}}}),r()&&window.addEventListener("resize",s)}function s(){for(var e=document.querySelectorAll(".flourish-embed"),i=0;i<e.length;i++){var n=e[i];if(!n.getAttribute("data-width"))n.querySelector("iframe").style.width=n.offsetWidth+"px"}}!function(){if(window.top!==window.self){var e,s=(i="#amp=1"==window.location.hash,{isFixedHeight:n,getHeightForBreakpoint:t,startEventListeners:a,notifyParentWindow:o,isSafari:r}),d=!0;Flourish.uploadImage=function(e){if("story_editor"!==Flourish.environment)throw"Invalid upload request";var i={sender:"Flourish",method:"request-upload",name:e.name,accept:e.accept};window.parent.postMessage(JSON.stringify(i),"*")},Flourish.setHeight=function(i){Flourish.fixed_height||(e=i,d=null==i,u())},Flourish.checkHeight=function(){var e=Flourish.__container_height;null!=e?(Flourish.fixed_height=!0,s.notifyParentWindow(e)):s.isFixedHeight()?Flourish.fixed_height=!0:(Flourish.fixed_height=!1,u())},Flourish.fixed_height=s.isFixedHeight(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()}else Flourish.setHeight=function(){};function u(){var i;Flourish.fixed_height||(null!=e?i=e:d&&(i=s.getHeightForBreakpoint()),i!==window.innerHeight&&s.notifyParentWindow(i))}function c(){u(),window.addEventListener("resize",u)}}()}();
